# BGP. Фильтрация



#### Цель:

Настроить фильтрацию для офисе Москва
Настроить фильтрацию для офисе С.-Петербург

#### Описание/Пошаговая инструкция выполнения домашнего задания:

В этой самостоятельной работе мы ожидаем, что вы самостоятельно:

1. Настроим фильтрацию в офисе Москва так, чтобы не появилось транзитного трафика(As-path).
2. Настроим фильтрацию в офисе С.-Петербург так, чтобы не появилось транзитного трафика(Prefix-list).
3. Настроим провайдера Киторн так, чтобы в офис Москва отдавался только маршрут по умолчанию.
4. Настроим провайдера Ламас так, чтобы в офис Москва отдавался только маршрут по умолчанию и префикс офиса С.-Петербург.



#### 1. Настроим фильтрацию в офисе Москва так, чтобы не появилось транзитного трафика(As-path).

Для этого создадим as-path access-list, в котором укажем отбор AS-Path только маршрутов, оригинированных AS-1001(as, в которой располагаются роутеры R14 и R15). Затем применим правило разрешения прохождения трафика посредством route-map, и наконец применим это правило на исходящий к соседу(R22 Киторн) трафик.

![image](https://github.com/SalminKHV/OTUS/assets/130359715/48dc6251-2dda-4522-a9dc-a94579edbfc2)



Обратим внимание, что на R14 приходит только маршрут по умолчанию от R22 (провайдер Киторн, выполнив тем самым сразу **третье задание**), выполнили мы Это задание создав префикс лист, который пропускает только один маршрут (по умолчанию 0.0.0.0./0) и назначили этот лист на уходищий трафик к соседу R14:

![image](https://github.com/SalminKHV/OTUS/assets/130359715/fcb04463-6a6d-4298-9dbe-d1d0d3243452)



Тоже самое, что и на R 14 сделаем на R15 и попутно выполним **четвертое задание**(добавив префикс лист, как на R22)

![image-20231004230017299](C:\Users\Gyper\AppData\Roaming\Typora\typora-user-images\image-20231004230017299.png)

 R21:

![image](https://github.com/SalminKHV/OTUS/assets/130359715/5a4bcc73-a9f5-4167-a887-4479d2ade4c2)



Для выполнения третьего задания можно ничего не настраивать, но мы выполним защиту от дурака, добавив соответствующие префикс листы на исходящий трафик к обоим соседям: 

![image](https://github.com/SalminKHV/OTUS/assets/130359715/f61cc471-21f1-4362-b495-13ec2248050c)

Проблему с маршрутом по умолчанию удалось решить так, сначала на R16 увеличил Distrabce  для маршрута 0.0.0.0/0 до 250, а затем создал маршрут по умолчанию в NULL0 на R18, затем добавил трансляцию подсети 0.0.0.0/32 в трансляцию eigrp.

IP - связность сетей присутствует:



![image](https://github.com/SalminKHV/OTUS/assets/130359715/0014898c-c9c6-41c5-87df-7cdc7ff118bc)
